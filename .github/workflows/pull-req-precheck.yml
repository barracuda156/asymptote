name: pull-request-precheck

on:
  workflow_dispatch:
  pull_request:
    branches:
      - "master"
      - "a/*"

jobs:
  build-asy-linux:
    uses: ./.github/workflows/build-asy-linux.yml
  build-asy-windows:
    uses: ./.github/workflows/build-asy-windows.yml
  test-asy-linux:
    needs: [build-asy-linux]
    uses: ./.github/workflows/test-asy-linux.yml
  test-asy-windows:
    needs: [build-asy-windows]
    uses: ./.github/workflows/test-asy-windows.yml
  build-gui:
    uses: ./.github/workflows/build-gui.yml
  package-asy-install-file:
    needs:
      - build-asy-windows
      - build-gui
      - build-asy-linux
    uses: ./.github/workflows/package-asy-installer-win.yml
  precheck-pass:  # this is a dummy step with the sole purpose of making the PR need only this job to pass
    needs:
      - test-asy-linux
      - test-asy-windows
      - package-asy-install-file
    runs-on: "ubuntu-22.04"
    steps:
      - run: echo All prechecks pass!
